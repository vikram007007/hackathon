<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Buy Operations</title>
    <link rel="stylesheet" href="stylesheets/history.css" />
	<link rel="stylesheet" href="css/templatemo-style.css">
	<script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    <script>
    
    function getBuy() {
       // done using promise using then function syntax
        fetch('stocks/buy').then(function(result) {
            return result.json();
        }).then(function (tradeList) {
        	 
        	

            let htmlString="<h1>Sell trades</h1>";
            tradeList.map((trade) => {
            	
            	htmlString+="<div id=\"pricing-table\">";
                htmlString+= "<div class=\"plan\">";
                
                htmlString+="<h3>" + trade.ticker + "<span>" + trade.price +"$"+"</span></h3>";
                
                var str1 = "FILLED";
                var str2 = trade.state;
                var n = str1.localeCompare(str2);
                if(n==0)
                	{
                	var url="sellstocks.html?ticker="+trade.ticker;
                	   htmlString+="<a class=\"signup\" href=\""+url+"\">Sell</a>";

                	}
                else
                   {
                 htmlString+="<a class=\"signup\" href='#' onClick=\"alert('Cannot sell this trade');\">Sell</a>";
                   }
                
                
                var d = new Date(trade.date);

                var date = d.getDate();
                var month = d.getMonth(); 
                var year = d.getFullYear();

                var dateString = date + "-" +(month + 1) + "-" + year;
                
                htmlString+="<ul><li>" + dateString + "</li>";
                htmlString+="<li><b>Quantity:</b>" + trade.quantity+ "</li>";
                htmlString+="<li><b>State:</b>" + trade.state+ "</li></ul></div></div>";
                
                
            });
        
            document.getElementById("tradeDiv").innerHTML = htmlString;
        });
    }
   
           
    </script>
</head>


<body onLoad="getBuy()">
   <nav>
        <div class="logo">
            <a href="index.html">Code<em>Chefs</em> in Making</a>
        </div>
        <div class="menu-icon">
        <span></span>
      </div>
    </nav>
       
        
 
  <div id="tradeDiv"></div>
  <section class="overlay-menu">
      <div class="container">
        <div class="row">
          <div class="main-menu">
              <ul>
                  <li>
                      <a href="index.html">Home</a>
                  </li>
                  <li>
                      <a href="buy_history.html">Buy History</a>
                  </li>
                  <li>
                      <a href="sell_history.html">Sell History</a>
                  </li>
                  <li>
                      <a href="buystock.html">Buy Stock</a>
                  </li>
                  <li>
                      <a href="sellstock.html">Sell Stock</a>
                  </li>
                  <li>
                      <a href="https://docdro.id/4kpZyXR">Trading advice</a>
                  </li>
              </ul>
          </div>
        </div>
      </div>
    </section>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>

    <script src="js/vendor/bootstrap.min.js"></script>
    
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>
    
   
</body>
</html>